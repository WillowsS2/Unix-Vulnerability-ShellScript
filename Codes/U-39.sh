#!/bin/bash

# log파일로 해당 진단 내용 파일 생성 
. function.sh
TMP1=`SCRIPTNAME`.log
> $TMP1

BAR
CODE [ U-39 ] 웹서비스 링크 사용금지
cat << EOF >> $RESULT
[ 양호 ] : 심볼릭 링크, aliases 사용을 제한한 경우
[ 취약 ] : 심볼릭 링크, aliases 사용을 제한하지 않은 경우
EOF
BAR

FILE=/etc/httpd/conf/httpd.conf

# 파일에서 FollowSymLinks 부분 중 주석이 없는 문자열 출력
cat $FILE | grep FollowSymLinks | grep -v '#' > $TMP1
# cat /etc/httpd/conf/httpd.conf | grep FollowSymLinks | grep -v '#'
if [ -s $TMP1 ] ; then
    WARN $FILE 파일에서 FollowSymLinks 옵션을 삭제하거나 -FollowSymLinks 로 변경해야 합니다.
    INFO $TMP1 파일을 확인해야 합니다.
else
    OK $FILE 파일에서 FollowSymLinks 옵션이 설정되어있지 않습니다.
    rm $TMP1
fi

cat $RESULT
echo;