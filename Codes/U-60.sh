#!/bin/bash
. function.sh

BAR
CODE [ U-60 ] SSH 원격접속 허용
cat << EOF >> $RESULT
[ 양호 ] : 원격 접속 시 SSH 프로토콜을 사용하는 경우
[ 취약 ] : 원격 접속 시 Telnet, SSH 등 안전하지 않은 프로토콜을 사용하는 경우
EOF
BAR

# SSH 확인
ps -ef | grep sshd | grep -v grep > tmp1.log
if [ -s tmp1.log ] ; then
    WARN ssh 서비스를 사용 중입니다.
else
    OK ssh 서비스를 사용하고 있지 않습니다.
fi
rm tmp1.log

# Telnet 확인
ps -ef | grep xinetd | grep -v grep > tmp2.log
if [ -s tmp2.log ] ; then
    WARN Telnet 서비스를 사용 중입니다.
else
    OK Telnet 서비스를 사용하고 있지 않습니다.
fi
rm tmp2.log

cat $RESULT
echo;