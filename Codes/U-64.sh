#!/bin/bash
. function.sh

BAR
CODE [ U-64 ] ftpusers 파일 설정\(FTP 서비스 root 계정 접근제한\)
cat << EOF >> $RESULT
[ 양호 ] : FTP 서비스가 비활성화 되어 있거나, 활성화 시 root 계정 접속을 차단한 경우
[ 취약 ] : FTP 서비스가 활성화 되어 있고, root 계정 접속을 허용한 경우
EOF
BAR

FILE=/etc/vsftpd/ftpusers

# FTP 확인
ps -ef | grep ftp | grep -v grep >> tmp.log
if [ -s tmp.log ] ; then
    WARN FTP 서비스가 활성화되어 있습니다.
else
    OK FTP 서비스가 비활성화되어 있습니다.
fi
rm tmp.log

# root 계정 접속 허용 여부 확인
cat $FILE | grep 'root' | grep -v '#' >/dev/null  # 주석 없는 것
if [ $? -eq 0 ] ; then
    WARN root 계정 접속을 허용합니다.
else
    OK root 계정 접속을 차단합니다.
fi

cat $RESULT
echo;