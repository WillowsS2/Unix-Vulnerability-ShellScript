#!/bin/bash

# log파일로 해당 진단 내용 파일 생성 
. function.sh
TMP1=`SCRIPTNAME`.log
> $TMP1

BAR
CODE [ U-41 ] 웹서비스 영역의 분리
cat << EOF >> $RESULT
[ 양호 ] : DocumentRoot를 별도의 디렉터리로 지정한 경우
[ 취약 ] : DocumentRoot를 기본 디렉터리로 지정한 경우
EOF
BAR

FILE=/etc/httpd/conf/httpd.conf
INFO $TMP1 파일을 확인해야 합니다.

# DocumentRoot 값 뽑아내는 명령어
cat $FILE | grep DocumentRoot | grep -v '#' | grep '"' > $TMP1
LINE=`cat $FILE | grep DocumentRoot | grep -v '#' | grep '"' | awk '{print $2}'`
# cat /etc/httpd/conf/httpd.conf | grep DocumentRoot | grep -v '#' | grep '"' | awk '{print $2}'
INFO 현재 DocumentRoot 값은 $LINE입니다.

# 경로 비교
if [[ "$LINE" == */usr/local/apache/htdocs* || "$LINE" == */usr/local/apache2/htdocs* || "$LINE" == */var/www/html* ]] ; then
    WARN DocumentRoot 값이 기본경로입니다.
else
    OK DocumentRoot 값이 기본경로가 아닙니다.
fi

cat $RESULT
echo;