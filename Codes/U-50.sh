#!/bin/bash

# log파일로 해당 진단 내용 파일 생성 
. function.sh
TMP1=`SCRIPTNAME`.log
> $TMP1

BAR
CODE [ U-50 ] 관리자 그룹에 최소한의 계정 포함
cat << EOF >> $RESULT
[ 양호 ] : 관리자 그룹에 불필요한 계정이 등록되어 있지 않은 경우
[ 취약 ] : 관리자 그룹에 불필요한 계정이 등록되어 있는 경우
EOF
BAR

echo "[ root 그룹 사용자 목록 ]" > $TMP1
# 관리자 그룹 내 불필요 계정 등록 유무 확인
cat /etc/group | grep root: | awk -F: '{print $4}'>> $TMP1
if [ -z $? ] ; then
    WARN 관리자 그룹에 불필요한 계정이 등록되어 있습니다.
    INFO $TMP1 파일을 확인해야 합니다.
else
    OK 관리자 그룹에 불필요한 계정이 등록되어 있지 않습니다.
    rm $TMP1
fi

cat $RESULT
echo;