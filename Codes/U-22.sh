#!/bin/bash
. function.sh

BAR
CODE [ U-22 ] crond 파일 소유자 및 권한 설정
cat << EOF >> $RESULT
[ 양호 ] : crontab 명령어 일반사용자 금지 및 cron 관련 파일 권한이 640 이하인 경우
[ 취약 ] : crontab 명령어 일반사용자 사용가능하거나, crond 관련 파일 권한이 640 이상인 경우 
EOF
BAR

# ls -al /usr/bin/crontab
FILE1=/etc/crontab
FILE2=/usr/bin/crontab
CHECK1=`ls -al $FILE1`
CHECK2=`ls -al $FILE2`

# 파일 유무/권한 확인
if [ -n "$CHECK1" ] ; then
    INFO $FILE1 파일이 존재합니다.
    PERMCHECK1=`su - root -c 'find $FILE1 -perm 640'`
    if [ -n "$PERMCHECK1" ] ; then # 출력 문자열이 0이 아닌 경우
        OK $FILE1 의 권한 설정이 되어있습니다.
    else
    WARN $FILE1 의 권한 설정이 잘못 되어있습니다.
    fi
else
    INFO $FILE1 파일이 존재하지 않습니다.
fi


if [ -n "$CHECK2" ] ; then
    INFO $FILE2 파일이 존재합니다.
    PERMCHECK2=`su - root -c 'find $FILE2 -perm 640'`
    if [ -n "$PERMCHECK2" ] ; then # 출력 문자열이 0이 아닌 경우
        OK $FILE2 의 권한 설정이 되어있습니다.
    else
        WARN $FILE2 의 권한 설정이 잘못 되어있습니다.
    fi
else
    INFO $FILE2 파일이 존재하지 않습니다.
fi

cat $RESULT
echo;