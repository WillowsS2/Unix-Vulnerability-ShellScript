#!/bin/bash
. function.sh

BAR
CODE [ U-45 ] root 계정 su 제한
cat << EOF >> $RESULT
[ 양호 ] : su 명령어를 특정 그룹에 속한 사용자만 사용하도록 제한되어 있는 경우
           + 일반사용자 계정 없이 root 계정만 사용하는 경우 su 명령어 사용 제한이 불필요함
[ 취약 ] : su 명령어를 모든 사용자가 사용하도록 설정되어 있는 경우
EOF
BAR

GOURPFILE=/etc/group
PAMFILE=/etc/pam.d/su

# 파일 내 모듈 사용 여부 확인
egrep -v '(^#|^$)' $PAMFILE | grep -q pam_wheel.so
if [ $? -eq 0 ] ; then
	INFO 'pam_wheel.so 모듈을 사용하고 있습니다.'
	if grep -q wheel $GOURPFILE ; then
		INFO 'wheel 그룹이 존재합니다.'
	else
		INFO 'wheel 그룹이 존재하지 않습니다.'
	fi
	OK 'su 명령어를 특정 그룹에 속한 사용자만 사용하도록 제한되어 있는 경우입니다.'
else
	WARN 'su 명령어를 모든 사용자가 사용하도록 설정되어 있는 경우입니다.'
fi

cat $RESULT
echo;