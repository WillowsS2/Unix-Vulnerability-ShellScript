#!/bin/bash
. function.sh

BAR
CODE [ U-31 ] 스팸 메일 릴레이 제한
cat << EOF >> $RESULT
[ 양호 ] : SMTP 서비스를 사용하지 않거나 릴레이 제한이 설정되어 있는 경우 
[ 취약 ] : SMTP 서비스를 사용하며 릴레이 제한이 설정되어 있지 않은 경우
EOF
BAR

# 릴레이 제한 설정 확인
FILE1=/etc/mail/sendmail.cf
FILE2=/etc/sendmail.cf
CHECK1=`cat $FILE1 | grep "R$\*" | grep "Relaying denied" | cut -c 1`
CHECK2=`cat $FILE2 | grep "R$\*" | grep "Relaying denied" | cut -c 1`

if [[ ${CHECK1} == '#' || ${CHECK2} == '#' ]] ; then
    WARN SMTP 서비스를 사용하며 릴레이 제한이 설정되어 있지 않습니다.
else
    OK SMTP 서비스를 사용하지 않거나 릴레이 제한이 설정되어 있습니다.
fi

cat $RESULT
echo;