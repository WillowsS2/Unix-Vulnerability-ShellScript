#!/bin/bash

# log파일로 해당 진단 내용 파일 생성 
. function.sh
TMP1=`SCRIPTNAME`.log
> $TMP1

BAR
CODE [ U-30 ] Sendmail 버전 점검
cat << EOF >> $RESULT
[ 양호 ] : Sendmail 버전이 최신버전인 경우 
[ 취약 ] : Sendmail 버전이 최신버전이 아닌 경우 
EOF
BAR

INFO $TMP1 파일을 확인해야 합니다.
echo quit | sleep 1 | telnet localhost 25 > $TMP1   # 텔넷 연결 통해 버전 확인
VERSION=`cat $TMP1 | awk '{print $5}' | grep -v "^$" | awk -F/ '{print $1}'`  # 버전 확인
if [ -n $VERSION ] ; then
    INFO Sendmail이 존재하지 않거나, 버전확인이 되지 않습니다.
else
    INFO 현재 $VERSION 버전을 사용하고 있습니다.
fi

cat $RESULT
echo;