#!/bin/bash

# log파일로 해당 진단 내용 파일 생성 
. function.sh
TMP1=`SCRIPTNAME`.log
> $TMP1

BAR
CODE [ U-40 ] 웹서비스 파일 업로드 및 다운로드 제한
cat << EOF >> $RESULT
[ 양호 ] : 파일 업로드 및 다운로드를 제한한 경우
[ 취약 ] : 파일 업로드 및 다운로드를 제한하지 않은 경우
EOF
BAR

INFO “/” 는 모든 파일 사이즈를 5m로 제한하는 설정 단위 : byte 입니다.
FILE=/etc/httpd/conf/httpd.conf

# 파일에서 LimitRequestBody 부분 중 주석이 없는 문자열 출력
cat $FILE | grep LimitRequestBody > $TMP1
# cat /etc/httpd/conf/httpd.conf | grep LimitRequestBody | grep -v '#'
if [ -s $TMP1 ] ; then
    OK $FILE 파일에서 LimitRequestBody 옵션이 설정되어 있습니다.
    INFO $TMP1 파일에서 설정 내용 확인이 가능합니다.
else
    WARN $FILE 파일에서 LimitRequestBody 옵션이 설정되어있지 않습니다.
    rm $TMP1
fi

cat $RESULT
echo;