#!/bin/bash

# log파일로 해당 진단 내용 파일 생성 
. function.sh
TMP1=`SCRIPTNAME`.log
> $TMP1

BAR
CODE [ U-18 ] 접속 IP 및 포트 제한
cat << EOF >> $RESULT
[ 양호 ] : 접속을 허용할 특정 호스트에 대한 IP 주소 및 포트 제한을 설정한 경우
[ 취약 ] : 접속을 허용할 특정 호스트에 대한 IP 주소 및 포트 제한을 설정하지 않은 경우
EOF
BAR

FILE1=/etc/hosts.deny
FILE2=/etc/hosts.allow

# 파일 내 주석처리가 안된 부분만 출력함
cat $FILE1 | egrep -v '(^#|^$)' >> $TMP1
cat $FILE2 | egrep -v '(^#|^$)' >> $TMP1

if [ -s $TMP1 ] ; then
    cat $TMP1
    INFO $TMP1 파일을 참고하여 설정을 변경해야 합니다.
else
    WARN /etc/hosts.deny,allow 설정이 되어있지 않습니다.
fi

cat $RESULT
echo;