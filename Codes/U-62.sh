#!/bin/bash
. function.sh

BAR
CODE [ U-62 ] FTP 계정 shell 제한
cat << EOF >> $RESULT
[ 양호 ] : FTP 계정에 /bin/false 쉘이 부여되어 있는 경우
[ 취약 ] : FTP 계정에 /bin/false 쉘이 부여되어 있지 않은 경우
EOF
BAR

# FTP 유저 확인
cat /etc/passwd | grep ftp >> tmp.log
CHECK=`cat tmp.log | awk -F: '{print $NF}' | awk -F/ '{print $NF}'`
# cat /etc/passwd | grep ftp | awk -F: '{print $NF}' | awk -F/ '{print $NF}'

if [ $CHECK == 'nologin' ] || [ $CHECK == 'false' ] ; then
    OK FTP 계정에 shell이 부여되어 있지 않습니다.
else
    WARN FTP 계정에 $CHECK shell이 부여되어 있습니다.
fi
rm tmp.log

cat $RESULT
echo;