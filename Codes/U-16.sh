#!/bin/bash

# log파일로 해당 진단 내용 파일 생성 
. function.sh
TMP1=`SCRIPTNAME`.log
> $TMP1

BAR
CODE [ U-16 ] /dev에 존재하지 않는 device 파일 점검
cat << EOF >> $RESULT
[ 양호 ] : dev에 대한 파일 점검 후 존재하지 않는 device 파일을 제거한 경우
[ 취약 ] : dev에 대한 파일 미점검 또는, 존재하지 않는 device 파일을 방치한 경우
EOF
BAR

# 일반 파일 유무 확인 (디바이스 파일은 권한 앞에 c가 붙고, Major/Minor Number가 설정됨)
TMP=$(mktemp)
find /dev -type f -exec ls -l {} \; > $TMP
$TMP >> $TMP1
if [ -s $TMP ] ; then
	WARN 파일이 존재합니다. 
	INFO $TMP1 파일을 확인해야 합니다.
    INFO "고객사와 상의하여 존재하지 않는 디바이스 파일이 존재하는지 확인하세요."
    INFO "존재하지 않는 디바이스 파일이 존재한다면 해당 파일을 삭제해야 합니다."
else
	OK 파일이 존재하지 않습니다.
	rm $TMP1
fi

cat $RESULT
echo;