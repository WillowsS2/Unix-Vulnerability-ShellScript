#!/bin/bash

# log파일로 해당 진단 내용 파일 생성 
. function.sh
TMP1=`SCRIPTNAME`.log
> $TMP1

BAR
CODE [ U-71 ] Apache 웹 서비스 정보 숨김
cat << EOF >> $RESULT
[ 양호 ] : ServerTokens Prod, ServerSignature Off로 설정되어있는 경우
[ 취약 ] : ServerTokens Prod, ServerSignature Off로 설정되어있지 않은 경우
EOF
BAR

FILE=/etc/httpd/conf/httpd.conf

# 파일에서 ServerTokens 부분 중 주석이 없는 문자열 출력
cat $FILE | grep -i ServerTokens | grep -v '#' > $TMP1
# 설정 확인
CHECK1=`echo $TMP1 | grep -i servertokens | awk '{print $2}'`
if [ $"CHECK1" == 'Prod' ] ; then
    OK ServerTokens Prod 설정이 되어 있습니다.
else
    WARN ServerTokens Prod 설정이 되어있지 않습니다.
fi

# 파일에서 ServerSignature 부분 중 주석이 없는 문자열 출력
cat $FILE | grep -i ServerSignature | grep -v '#' > $TMP1
# 설정 확인
CHECK2=`echo $TMP1 | grep -i ServerSignature | awk '{print $2}'`
if [ $"CHECK2" == 'Off' ] ; then
    OK ServerSignature Off로 설정이 되어 있습니다.
else
    WARN ServerSignature Off로 설정이 되어있지 않습니다.
fi
rm $TMP1

cat $RESULT
echo;