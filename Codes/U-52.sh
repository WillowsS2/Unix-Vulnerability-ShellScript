#!/bin/bash
. function.sh

BAR
CODE [ U-52 ] 동일한 UID 금지
cat << EOF >> $RESULT
[ 양호 ] : 동일한 UID로 설정된 사용자 계정이 존재하지 않는 경우
[ 취약 ] : 동일한 UID로 설정된 사용자 계정이 존재하는 경우
EOF
BAR

# /etc/passwd 파일 내 UID 출력
cat /etc/passwd |awk -F: '{print $3}' > tmp.log
cat tmp.log | uniq >tmp2.log
# 두 파일 내용 비교
diff tmp.log tmp2.log >> /dev/null 2>&1

if [ $? -eq 0 ]; then
    OK 동일한 UID로 설정된 사용자 계정이 존재하지 않습니다.
else
    WARN 동일한 UID로 설정된 사용자 계정이 존재합니다
fi
rm tmp.log tmp2.log

cat $RESULT
echo;