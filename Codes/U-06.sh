#!/bin/bash

# log파일로 해당 진단 내용 파일 생성 
. function.sh
TMP1=`SCRIPTNAME`.log
> $TMP1

BAR
CODE [ U-06 ] 파일 및 디렉터리 소유자 설정
cat << EOF >> $RESULT
[ 양호 ] : 소유자가 존재하지 않는 파일 및 디렉터리가 존재하지 않는 경우
[ 취약 ] : 소유자가 존재하지 않는 파일 및 디렉터리가 존재하는 경우
EOF
BAR

TMP2=`mktemp` # 결과 저장
# 소유자나 소유그룹이 없는 파일, 디렉터리 찾는 명령어
# ex) /etc/passwd, /etc/shadow 파일에 유저 정보가 없는 경우
find / \( -nouser -o -nogroup \) 2>/dev/null >$TMP2

if [ -s $TMP2 ] ; then
    WARN 소유자나 소유그룹이 존재하지 않는 파일, 디렉토리가 존재합니다.
    INFO $TMP1 파일의 내용을 참고합니다.
cat << EOF >> $TMP1
다음 목록은 소유자가 존재하지 않은 파일 및 디렉토리가 존재하는 목록입니다.
반드시 고객과 상의하여 필요없는 경우 삭제하시기 바랍니다.

EOF
cat $TMP2 >> $TMP1
else
    OK 소유자나 소유그룹이 존재하지 않는 파일 및 디렉토리가 존재하지 않습니다.
    rm $TMP1
fi

cat $RESULT
echo;