#!/bin/bash

# log파일로 해당 진단 내용 파일 생성 
. function.sh
TMP1=`SCRIPTNAME`.log
> $TMP1

BAR
CODE [ U-72 ] 정책에 따른 시스템 로깅 설정
cat << EOF >> $RESULT
[ 양호 ] : 로그 기록 정책이 정책에 따라 설정되어 수립되어 있으며 보안정책에 따라 로그를 남기고 있을 경우
[ 취약 ] : 로그 기록 정책 미수립 또는, 정책에 따라 설정되어 있지 않거나 보안정책에 따라 로그를 남기고 있지 않을 경우
EOF
BAR

FILE=/etc/rsyslog.conf
INFO $TMP1 파일을 참고하여 $FILE 파일을 설정해야 합니다.

cat << EOF > $TMP1
[ /etc/rsyslog.conf 파일 설정]

 1) 아래와 같이 수정합니다.
*.info;mail.none;authpriv.none;cron.none /var/log/messages
authpriv.* /var/log/secure
mail.* /var/log/maillog
cron.* /var/log/cron
*.alert /dev/console
*.emerg *

 2) 설정 후 SYSLOG 데몬을 재시작합니다.
# ps -ef | grep syslogd     //PID 확인
# kill -HIP [PID]

EOF

cat $RESULT
echo;