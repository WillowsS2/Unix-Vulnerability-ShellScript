#!/bin/bash

# log파일로 해당 진단 내용 파일 생성 
. function.sh
TMP1=`SCRIPTNAME`.log
> $TMP1

BAR
CODE [ U-49 ] 불필요한 계정 제거
cat << EOF >> $RESULT
[ 양호 ] : 불필요한 계정이 존재하지 않는 경우
[ 취약 ] : 불필요한 계정이 존재하는 경우
EOF
BAR

# 사용하지 않는 Default 계정 점검
echo "[ 사용하지 않는 Default 계정 ]" > $TMP1
cat /etc/passwd | egrep "lp|uucp|nuucp" >> $TMP1
if [ -z $? ] ; then
    OK 사용하지 않는 Default 계정이 존재하지 않습니다.
else
    WARN 사용하지 않는 Default 계정이 존재합니다.
    INFO $TMP1 파일을 확인해야 합니다.
fi

# 로그 파일을 통한 점검
INFO U-49_user.log 파일을 점검 해봐야 합니다.
INFO U-49_lastlog.log 파일을 점검 해봐야 합니다.
INFO U-49_suCMD.log 파일을 점검 해봐야 합니다.

cat /etc/passwd >> U-49_user.log
lastlog >> U-49_lastlog.log
cat /var/log/secure* | grep 'su: pam_unix(su-l:auth): authentication failure' >> U-49_suCMD.log

cat $RESULT
echo;